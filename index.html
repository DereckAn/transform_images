<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Transform Images - Image Optimizer</title>

    <!-- Styles (Tailwind will be processed by Vite) -->
    <link rel="stylesheet" href="/src/styles.css" />

    <!-- Main TypeScript -->
    <script type="module" src="/src/main.ts" defer></script>
  </head>

  <body class="bg-background-dark font-display text-slate-200 scrollbar-thin">
    <div class="relative flex h-screen w-full">
      <!-- ==================== SIDEBAR ==================== -->
      <aside
        class="flex w-100 flex-col border-r border-slate-800 bg-background-dark/50"
      >
        <div class="flex h-full flex-col justify-between p-4">
          <!-- Header -->
          <div class="flex flex-col gap-6">
            <div class="flex items-center gap-3 px-2">
              <!-- Reemplazar el div del emoji por una imagen -->
              <div class="relative cursor-pointer" id="logo-container">
                <img
                  src="/src/assets/patoblack.png"
                  alt="Transform Images Logo"
                  class="size-16 rounded-full object-cover"
                />
                <span
                  id="update-indicator"
                  class="absolute -top-1 -right-1 size-3 bg-blue-500 rounded-full hidden animate-pulse"
                ></span>
              </div>
              <div class="flex flex-col">
                <h1 class="text-lg font-bold leading-normal text-white">
                  Transform Images
                </h1>
                <p class="text-sm font-normal leading-normal text-slate-400">
                  Image Optimizer
                </p>
              </div>
            </div>

            <!-- Settings Section -->
            <div
              class="flex flex-col gap-4 overflow-y-auto scrollbar-thin pr-2"
              style="max-height: calc(100vh - 250px)"
            >
              <!-- Optimization Settings (Always Visible) -->
              <div class="flex flex-col gap-4">
                <h3
                  class="text-sm font-semibold text-red-400 uppercase tracking-wider"
                >
                  Optimization
                </h3>

                <!-- Quality Slider -->
                <div class="flex flex-col gap-2">
                  <div class="flex items-center justify-between">
                    <label class="text-sm font-medium text-slate-200"
                      >Quality</label
                    >
                    <span id="quality-value" class="text-sm text-slate-400"
                      >85%</span
                    >
                  </div>
                  <input
                    type="range"
                    id="quality"
                    min="1"
                    max="100"
                    value="85"
                    class="w-full h-1.5 bg-slate-700 rounded-full appearance-none cursor-pointer accent-primary"
                  />
                </div>

                <!-- Output Format -->
                <label class="flex flex-col gap-2">
                  <span class="text-sm font-medium text-slate-200">Format</span>
                  <div class="relative">
                    <select
                      id="output-format"
                      class="w-full appearance-none rounded-lg border border-slate-700 bg-slate-800 px-3 py-2.5 pr-10 text-sm text-slate-200 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"
                    >
                      <option value="">Keep Original</option>
                      <option value="jpeg">JPEG</option>
                      <option value="png">PNG</option>
                      <option value="webp">WebP</option>
                    </select>
                    <span
                      class="pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-slate-400"
                      >‚ñº</span
                    >
                  </div>
                </label>

                <!-- Output Directory -->
                <label class="flex flex-col gap-2">
                  <span class="text-sm font-medium text-slate-200"
                    >Output Directory</span
                  >
                  <div class="flex gap-2">
                    <input
                      type="text"
                      id="output-dir"
                      readonly
                      placeholder="Same as source"
                      class="flex-1 rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-sm text-slate-200 placeholder:text-slate-500 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"
                    />
                    <button
                      id="select-dir-btn"
                      class="px-3 py-2 rounded-lg bg-slate-700 text-slate-200 hover:bg-slate-600 transition-colors text-sm font-medium"
                    >
                      Browse
                    </button>
                  </div>
                </label>

                <!-- Checkboxes -->
                <label class="flex items-center gap-3 cursor-pointer">
                  <input
                    type="checkbox"
                    id="preserve-metadata"
                    class="w-4 h-4 rounded border-slate-600 bg-slate-800 text-primary focus:ring-2 focus:ring-primary/20 focus:ring-offset-0"
                  />
                  <span class="text-sm text-slate-200"
                    >Preserve EXIF metadata</span
                  >
                </label>

                <label class="flex items-center gap-3 cursor-pointer">
                  <input
                    type="checkbox"
                    id="overwrite-existing"
                    class="w-4 h-4 rounded border-slate-600 bg-slate-800 text-primary focus:ring-2 focus:ring-primary/20 focus:ring-offset-0"
                  />
                  <span class="text-sm text-slate-200"
                    >Overwrite existing files</span
                  >
                </label>
              </div>

              <!-- Divider -->
              <div class="border-t border-slate-800"></div>

              <!-- Transformations (Collapsible) -->
              <div class="flex flex-col gap-4">
                <button
                  id="toggle-transformations"
                  class="flex items-center justify-between text-sm font-semibold text-red-400 uppercase tracking-wider hover:text-slate-300 transition-colors"
                >
                  <span>üîÑ Transformations</span>
                  <span
                    id="transform-icon"
                    class="transform transition-transform"
                    >‚ñº</span
                  >
                </button>

                <div
                  id="transformations-content"
                  class="flex flex-col gap-4"
                  style="display: none"
                >
                  <!-- Resize -->
                  <div class="flex gap-2">
                    <label class="flex-1 flex flex-col gap-2">
                      <span class="text-sm font-medium text-slate-200"
                        >Width</span
                      >
                      <input
                        type="number"
                        id="resize-width"
                        placeholder="Auto"
                        class="w-full rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-sm text-slate-200 placeholder:text-slate-500 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"
                      />
                    </label>
                    <label class="flex-1 flex flex-col gap-2">
                      <span class="text-sm font-medium text-slate-200"
                        >Height</span
                      >
                      <input
                        type="number"
                        id="resize-height"
                        placeholder="Auto"
                        class="w-full rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-sm text-slate-200 placeholder:text-slate-500 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"
                      />
                    </label>
                  </div>

                  <label class="flex items-center gap-3 cursor-pointer">
                    <input
                      type="checkbox"
                      id="preserve-aspect-ratio"
                      checked
                      class="w-4 h-4 rounded border-slate-600 bg-slate-800 text-primary focus:ring-2 focus:ring-primary/20 focus:ring-offset-0"
                    />
                    <span class="text-sm text-slate-200"
                      >Maintain aspect ratio</span
                    >
                  </label>

                  <!-- Filter -->
                  <label class="flex flex-col gap-2">
                    <span class="text-sm font-medium text-slate-200"
                      >Resize Filter</span
                    >
                    <select
                      id="resize-filter"
                      class="w-full appearance-none rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-sm text-slate-200 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"
                    >
                      <option value="Lanczos3">Lanczos3 (Best)</option>
                      <option value="CatmullRom">CatmullRom</option>
                      <option value="Gaussian">Gaussian</option>
                      <option value="Triangle">Triangle</option>
                      <option value="Nearest">Nearest (Fastest)</option>
                    </select>
                  </label>

                  <!-- Rotation -->
                  <label class="flex flex-col gap-2">
                    <span class="text-sm font-medium text-slate-200"
                      >Rotate</span
                    >
                    <select
                      id="rotation"
                      class="w-full appearance-none rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-sm text-slate-200 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"
                    >
                      <option value="0">None</option>
                      <option value="90">90¬∞</option>
                      <option value="180">180¬∞</option>
                      <option value="270">270¬∞</option>
                    </select>
                  </label>

                  <!-- Flip -->
                  <label class="flex items-center gap-3 cursor-pointer">
                    <input
                      type="checkbox"
                      id="flip-horizontal"
                      class="w-4 h-4 rounded border-slate-600 bg-slate-800 text-primary focus:ring-2 focus:ring-primary/20 focus:ring-offset-0"
                    />
                    <span class="text-sm text-slate-200">Flip Horizontal</span>
                  </label>

                  <label class="flex items-center gap-3 cursor-pointer">
                    <input
                      type="checkbox"
                      id="flip-vertical"
                      class="w-4 h-4 rounded border-slate-600 bg-slate-800 text-primary focus:ring-2 focus:ring-primary/20 focus:ring-offset-0"
                    />
                    <span class="text-sm text-slate-200">Flip Vertical</span>
                  </label>

                  <!-- Reset Button -->
                  <button
                    id="reset-transformations"
                    class="w-full px-4 py-2 rounded-lg bg-slate-700 text-slate-200 text-sm font-medium hover:bg-slate-600 transition-colors"
                  >
                    Reset Transformations
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="flex flex-col gap-2 pt-4 border-t border-slate-800">
            <button
              id="process-btn"
              disabled
              class="w-full px-4 py-3 rounded-lg bg-primary text-white text-sm font-bold tracking-wide hover:bg-black/90 transition-colors disabled:opacity-30 disabled:cursor-not-allowed"
            >
              ‚ñ∂Ô∏è Start Processing
            </button>

            <button
              id="cancel-btn"
              style="display: none"
              class="w-full px-4 py-3 rounded-lg bg-red-600 text-white text-sm font-bold tracking-wide hover:bg-red-700 transition-colors"
            >
              Cancel
            </button>

            <button
              id="clear-all-btn"
              class="w-full px-4 py-2 rounded-lg bg-transparent text-slate-400 text-sm font-medium hover:bg-slate-800 transition-colors"
            >
              Clear All
            </button>

            <p class="text-xs text-center text-slate-500 pt-2">
              Threads: <span id="thread-count" class="font-semibold">0</span>
            </p>
          </div>
        </div>
      </aside>

      <!-- ==================== MAIN CONTENT AREA ==================== -->
      <main class="flex-1 p-8 bg-background-dark overflow-hidden">
        <div class="h-full w-full flex flex-col">
          <!-- Empty State (No images) -->
          <div
            id="drop-zone-view"
            class="flex items-center justify-center h-full"
          >
            <div id="drop-zone" class="w-full max-w-2xl">
              <div
                class="flex flex-col items-center gap-6 rounded-xl border-2 border-dashed border-slate-700 px-6 py-20 hover:border-slate-600 hover:bg-slate-900/20 transition-all cursor-pointer"
              >
                <div
                  class="flex items-center justify-center size-16 rounded-full bg-primary/20"
                >
                  <span class="text-4xl">üì§</span>
                </div>
                <div class="flex flex-col items-center gap-2">
                  <p class="text-xl font-bold text-white text-center">
                    Upload Images
                  </p>
                  <p class="text-sm text-slate-400 text-center">
                    Drop your images here or click to browse files from your
                    computer. Supports PNG, JPEG, WebP, and 30+ RAW formats.
                  </p>
                </div>
                <div class="flex gap-3">
                  <button
                    id="browse-btn"
                    class="px-6 py-3 rounded-lg bg-slate-800 text-slate-200 text-sm font-bold hover:bg-slate-700 transition-colors"
                  >
                    üìÑ Browse Files
                  </button>
                  <button
                    id="browse-folder-btn"
                    class="px-6 py-3 rounded-lg bg-slate-800 text-slate-200 text-sm font-bold hover:bg-slate-700 transition-colors"
                  >
                    üìÅ Browse Folder
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Images List View (When images selected) -->
          <div
            id="images-list-view"
            class="h-full flex flex-col gap-4"
            style="display: none"
          >
            <!-- Header with count -->
            <div
              class="flex items-center justify-between pb-4 border-b border-slate-800"
            >
              <div class="flex items-center gap-3">
                <h2 class="text-xl font-bold text-white">Selected Images</h2>
                <span
                  id="image-count"
                  class="px-3 py-1 rounded-full bg-slate-800 text-sm font-semibold text-slate-300"
                >
                  0
                </span>
              </div>
            </div>

            <!-- Image Grid -->
            <div
              id="images-list"
              class="flex-1 overflow-y-auto scrollbar-thin grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 pb-4"
              style="max-height: calc(100vh)"
            >
              <!-- Images will be added here dynamically -->
            </div>

            <!-- Progress Section -->
            <div
              id="progress-section"
              class="p-4 rounded-xl bg-slate-900/50 border border-slate-800"
              style="display: none"
            >
              <div class="flex items-center justify-between mb-2">
                <p
                  id="progress-text"
                  class="text-sm font-medium text-slate-300"
                >
                  Processing...
                </p>
                <p
                  id="progress-percent"
                  class="text-sm font-semibold text-slate-300"
                >
                  0%
                </p>
              </div>
              <div class="w-full h-2 bg-slate-800 rounded-full overflow-hidden">
                <div
                  id="progress-bar"
                  class="h-full bg-primary transition-all duration-300"
                  style="width: 0%"
                ></div>
              </div>
              <p id="current-file" class="text-xs text-slate-500 mt-2 truncate">
                Ready...
              </p>
            </div>

            <!-- Results Section -->
            <div
              id="results-section"
              class="p-6 rounded-xl bg-slate-900/50 border border-slate-800"
              style="display: none"
            >
              <h3 class="text-lg font-bold text-white mb-4">‚úÖ Results</h3>
              <div
                id="results-stats"
                class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"
              >
                <!-- Stats will be added here -->
              </div>
              <div
                id="results-list"
                class="max-h-60 overflow-y-auto scrollbar-thin space-y-2"
              >
                <!-- Result items will be added here -->
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
    <!-- Update Dialog -->
    <div
      id="update-dialog"
      class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden"
    >
      <div
        class="bg-slate-800 rounded-xl p-6 max-w-2xl w-full mx-4 border-4 border-slate-700"
      >
        <h2 class="text-lg font-bold text-white mb-2">Update Available</h2>
        <p id="update-version" class="text-sm text-slate-400 mb-4">
          A new version is available.
        </p>
        <div class="flex gap-3 justify-end">
          <button
            id="update-cancel"
            class="px-4 py-2 rounded-lg bg-slate-700 text-slate-200 hover:bg-slate-600 transition-colors text-sm font-medium"
          >
            Later
          </button>
          <button
            id="update-confirm"
            class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-500 transition-colors text-sm font-medium"
          >
            Update Now
          </button>
        </div>
      </div>
    </div>
  </body>
</html>
